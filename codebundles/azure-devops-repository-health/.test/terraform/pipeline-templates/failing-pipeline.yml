# Test pipeline for ${scenario} scenario
# This pipeline is designed to fail for testing repository health monitoring

trigger:
- main
- master

pool:
  vmImage: 'ubuntu-latest'

variables:
  scenario: '${scenario}'

stages:
- stage: Build
  displayName: 'Build Stage'
  jobs:
  - job: BuildJob
    displayName: 'Build Job'
    steps:
    - script: |
        echo "Building for scenario: $(scenario)"
        echo "This build is designed to fail for testing purposes"
        sleep 3
        echo "Simulating build failure..."
        exit 1
      displayName: 'Build Application (Will Fail)'

- stage: Test
  displayName: 'Test Stage'
  dependsOn: Build
  jobs:
  - job: TestJob
    displayName: 'Test Job'
    steps:
    - script: |
        echo "Running tests for scenario: $(scenario)"
        echo "Tests would run if build succeeded"
        sleep 2
        exit 1
      displayName: 'Run Tests (Will Fail)'

- stage: Deploy
  displayName: 'Deploy Stage'
  dependsOn: Test
  condition: and(succeeded(), eq(variables['Build.SourceBranch'], 'refs/heads/main'))
  jobs:
  - job: DeployJob
    displayName: 'Deploy Job'
    steps:
    - script: |
        echo "This stage should never run due to previous failures"
        exit 1
      displayName: 'Deploy Application (Should Not Run)' 